#!/bin/bash
# note-for-later - Create timestamped notes for later review
# Usage: note-for-later 'description' 'note content'
#
# Creates/appends to .tasks/agent_<description>.org with timestamped entries.
# The description becomes the filename slug (lowercase, spaces to underscores).

if [ $# -lt 2 ]; then
    echo "Usage: note-for-later 'description' 'note content'" >&2
    exit 1
fi

description="$1"
content="$2"

# Convert description to filename slug: lowercase, spaces to underscores
slug=$(echo "$description" | tr '[:upper:]' '[:lower:]' | tr ' ' '_' | tr -cd '[:alnum:]_-')

# Create .tasks directory if needed
tasks_dir=".tasks"
mkdir -p "$tasks_dir"

# Target file
file="$tasks_dir/agent_${slug}.org"

# Timestamp
timestamp=$(date '+%Y-%m-%d %H:%M:%S')

# Create file with header if it doesn't exist
if [ ! -f "$file" ]; then
    echo "#+TITLE: Notes: $description" > "$file"
    echo "" >> "$file"
fi

# Append timestamped entry
echo "* [$timestamp]" >> "$file"
echo "$content" >> "$file"
echo "" >> "$file"

echo "Note added to $file"
