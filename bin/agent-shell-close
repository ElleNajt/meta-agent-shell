#!/usr/bin/env bash
# agent-shell-close - Close an agent session
# Usage: agent-shell-close "buffer-name"

if [ $# -lt 1 ]; then
    echo "Usage: agent-shell-close \"buffer-name\"" >&2
    exit 1
fi

target="$1"

# Escape for elisp: backslashes first, then quotes
escaped_target=$(printf '%s' "$target" | sed 's/\\/\\\\/g; s/"/\\"/g')

emacsclient --eval "(meta-agent-shell-close-session \"$escaped_target\" $$)"
